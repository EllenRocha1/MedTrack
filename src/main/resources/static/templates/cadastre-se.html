<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastre-se</title>
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/button.css">
    <link rel="stylesheet" href="../css/cadastre-se.css">
</head>

<body>
    <header>
        <nav>
            <a href="home.html">
                <img src="../images/logo_site_verde_musgo.jpg" alt="Logo do site" id="logo">
            </a>
            <div id="auth-buttons">
                <a href="login.html" class="button" id="login-button-2">Entrar</a>
                <a href="cadastre-se.html" class="button" id="register-button">Cadastre-se</a>
            </div>
        </nav>
    </header>
    <main>
        <div id="titulo-conteiner">
            <h1>Cadastre-se</h1>
            <h5>Preencha suas informações para criar sua conta.</h5>
        </div>
        <form id="form">
            <section id="inputs-conteiner">
                <div id="input-conteiner-infos">
                    <input type="text" id="nome-completo" name="fullName" placeholder="Digite seu nome completo"
                        required pattern="^[a-zA-ZÀ-ÿ\s]+$" minlength="3" maxlength="100" class="input">
                    <input type="email" id="email" class="input" placeholder="Email"
                        pattern=".+@(outlook\.com|gmail\.com|yahoo\.com\|hotmail\.com)" required>

                    <input type="date" id="nascimento" name="aniversario" value="2025-01-19" class="input" />
                    <input type="tel" id="telefone" name="telefone" pattern="\(?[0-9]{2}\)?\s?[9]?[0-9]{4}-[0-9]{4}"
                        placeholder="(xx) xxxxx-xxxx" class="input" />

                </div>
                <div id="input-conteiner-criacao">
                    <input type="text" id="nome-de-usuario" minlength="5" maxlength="50" required
                        placeholder="Nome de usuario" class="input">
                    <input type="password" id="password-input" class="input"
                        placeholder="Senha (mínimo de 8 caracteres)" minlength="8" required>
                    <input type="password" id="password-input-confirmar" class="input" placeholder="Confirmar senha"
                        minlength="8" required>
                    <div id="checkbox-tipo-conta">
                        <fieldset>
                            <legend>Escolha o tipo de conta:</legend>
                            <input type="radio" id="Administrador" name="tipoConta" value ="ADMINISTRADOR" checked />
                            <label for="ADMINISTRADOR">Administrador</label>
                            <input type="radio" id="Pessoal" name="tipoConta"  value="PESSOAL"/>
                            <label for="PESSOAL">Pessoal</label>
                        </fieldset>
                    </div>

                </div>
            </section>
            <section id="criar-conta-section">
                <input type="submit" value="Criar conta" id="submit-button-criar-senha" class="submit-button">

                <div id="text-link-conteiner">
                    <p>Já possui uma conta?</p> <a href="login.html" class="link">Entrar</a>
                </div>
            </section>
        </form>

        <script>
            document.getElementById('form').addEventListener('submit', function (event) {
                event.preventDefault();  // Impede o envio padrão do formulário

                // Coleta os dados do formulário
                const nome = document.getElementById('nome-completo').value;
                const email = document.getElementById('email').value;
                const nomeUsuario = document.getElementById('nome-de-usuario').value;
                const senha = document.getElementById('password-input').value;
                const tipoConta = document.querySelector('input[name="tipoConta"]:checked').value;
                const dataNascimento = document.getElementById('nascimento').value;

                if (senha !== document.getElementById('password-input-confirmar').value) {
                    alert("As senhas não coincidem!");
                    return;
                }


                // Cria um objeto com os dados
                const usuario = {
                    nome: nome,
                    email: email,
                    nomeUsuario: nomeUsuario,
                    senha: senha,
                    tipoConta: tipoConta,
                    dataNascimento: dataNascimento
                };

                // Envia os dados para o backend
                fetch("http://localhost:8081/cadastre-se", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(usuario)
                })
                    .then(response => {
                        if (!response.ok) {
                            return response.json().then(err => {
                                console.error("Erro no backend:", err);
                                alert("Erro ao cadastrar usuário: " + err.error);
                            });
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log(data);
                        alert("Usuário cadastrado com sucesso!");
                    })
                    .catch(error => {
                        console.error("Erro ao cadastrar usuário:", error);
                        alert("Erro ao cadastrar usuário");
                    })
                    });

        </script>


    </main>
</body>
<footer></footer>

</html>